<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.20">
<meta name="author" content="George Kontsevich">
<title>Fixing the Mesoscale EOF by Climate Dipole Bisection</title>
<style>
@import '../web/kxygk.css';

html {
margin: 0;
overflow-x: hidden;
}
body {
margin-left: 0px;
margin-right: 0px;
margin-left: 5vw;
margin-right: 5vw;}
#table-of-contents {display: none} /* disable for now.. till I have a better plan */
.listingblock,pre.src {
margin-left:  0vw;
margin-right: 0vw;
font-family: monospace;
font-size: 100%;
background: #FFFFEE;
overflow: auto;
position: static;
border-top: 1px solid  #e5e5d6;
border-bottom: 1px solid  #e5e5d6;
}
pre.src-org {
color: red;
background: #FFFFFF;
}
blockquote {
width: 100%;
padding-left: 0.5em;
border-left: dotted;
border-left-width: 4px;
border-left-color: grey;
background-color: #eefaf6; /*#f1ffee;*/
margin: 0;
.org-center {
text-align: center;}
}
svg { /* newer inline SVGs */
width: 100vw;
overflow: hidden;
height: auto;
margin-left: -5vw;
margin-right: 0;
}
/*.org-svg {
width: 100vw;
display: block;
margin-left: auto;
margin-right: auto;
}*/

img {
    display:flex;
max-width: 100%;
max-height: 70vh;
vertical-align: middle;
margin: auto;
}
ul {
list-style-type: circle;
padding-left: 1.5em;
border-left: solid;
border-left-width: 1px;
border-left-color: grey;}
h1 {color: #596060;}
h2 {
    color: black;
    font-style: italic;
    padding-top: 0.5em;}
.sect1 {border-top: 4px solid  dimgray;}
.sect2 {border-top: 4px solid  dimgrey;}
h3 {color: black;
    margin-block-start: 0;
    margin-block-end: 0;
    padding-left: 0.5em;
    border-left: 4px solid  dimgrey;
    border-bottom: 4px solid  #aaaaaa;
    background:  #aaaaaa;}
h4 {border-bottom: 2px dashed  #aaaaaa;
    }
b, i{
    font-family: serif ;}
sup { /* fixes line spacing issues due to superscripts */
    font-size: 0.8em;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
    top: -0.5em;
}
sub { /* if these are missing then lines with subscripts take up more space */
font-size: 0.8em;
line-height: 0;
}
.title {
font-weight: bold;
}
dt {
font-weight: bold;
}
td p, dd p, li p{
    margin: 0;
}
ul, p{
    margin-top: 0;
}
.sidebarblock{
    background:#f3f3f2;
}
.float-group::before,.float-group::after{content:" ";display:table}
.left{float:left!important}
.right{float:right!important}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
.scrollbox{
    white-space: nowrap;
    overflow-x: scroll;
    scroll-snap-type: x mandatory;
}
.scrollbox img{
    height:auto;
    width:auto;
    max-width: 70vw;
    max-height: 60vh;
    vertical-align: bottom;
    scroll-snap-align: start;
}
video{
    height:auto;
    width:auto;
    max-width: 30vw;
    max-height: 30vh;
}
.content{
    height: 100%;
}
.imageblock{
    height: 100%;
}
.flexbox > .content{
    display: flex;
    justify-content: center;
    height: 33vh;
}

@media (max-width:60rem) {
.listingblock,pre.src {
    margin-left:  -5vw;
    margin-right: -5vw;
}}
@media (min-width:60rem) {
.sect2{
    column-count:2;
    hyphens: auto;
}
}
@media (min-width:90rem) {
.sect2{
    column-count:3;
}
}
@media (min-width:120rem) {
.sect2s{
    column-count:4;
}
}

</style>
<meta name="robots" content="noindex">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains("stemblock")) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="../MathJax/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</head>
<body class="article">
<div id="header">
<h1>Fixing the Mesoscale EOF by Climate Dipole Bisection</h1>
<div class="details">
<span id="author" class="author">George Kontsevich</span><br>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_abstract">Abstract</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Large scale climate processes,
in their interplay with topography,
leave distinct fingerprints on the spatial patterns of a region&#8217;s weather.
If these patterns are isolated,
an observer of the weather is able to infer which climate system is active at any given time.
Building on the singular value decomposition (SVD),
we present a method for estimating climate-associated patterns.
Mirroring the method of empirical orthogonal functions (EOF),
the region agnostic method eshews tuning parameters and heuristics ensuring impartiality.
Key is recognizing that many climate phenomena form non-coocurring dipoles.
Reduced to two dimensions by SVD,
weather records align around two dipole-associated linear combinations.
These combinations,
once isolated,
form the basis of regional two-state climate indices.
Unlike EOFs,
adjusted patterns can be compared across datasets and time periods.
We present an example using the IMERG precipitation dataset,
along with software for reproducing the results.</p>
</div>
<div class="paragraph">
<p>WORD LIMIT: 150
WORDS: 150</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_supplementary_sections">Supplementary Sections</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="./paper1-imerg.html">Notes on IMERG</a></p>
</li>
<li>
<p>Daily Data Thailand</p>
</li>
<li>
<p>Figure with all data from Synthetic example</p>
</li>
<li>
<p><a href="./paper1-normalization.html">Notes on Precipitation Data Normalization</a></p>
</li>
<li>
<p>Monthly Rain over Thailand</p>
</li>
<li>
<p><a href="./paper1-singleclimate.html">Single climate regions</a></p>
</li>
<li>
<p><a href="./paper1-errors.html">Error Analysis</a></p>
</li>
<li>
<p>ERA5 patterns vs IMERG</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_introduction">Introduction</h3>
<div class="paragraph">
<p>Climate systems,
such at the monsoons or El Nino/La Nina,
acquired their names when people native to a region noted recurring weather patterns.
By contrast,
a typical modern approach for identifying climate system involves searching for and then characterizing repeated atmospheric configurations.
These can come in the form of heuristics based on historic data,
such as Wang and LinHo&#8217;s (2002) monsoon onset/withdrawl thresholds method.
Another common approach is selecting regions that are somehow representative of the climate systems in question.
A good example is the monitoring of ENSO by sea surface temperature in the Nino 3.4 index,
as motivated by Trenberth (1997).
Nonetheless,
when climate systems are poorly understood or are still not well characterized,
the original methodology of pattern recognition comes naturally to the untrained eye.
While at times imperfect,
it presents a simple method that can be used regardless of location.
Pattern recognition,
as applied in the atmospheric sciences and oceanography,
has been typically done using empirical orthogonal function
(EOF)
analysis.
The resulting patterns,
(EOF1 EOF2 EOF3 etc.)
are meant to roughly represent the patterns that repeat in the weather observations.
The quality of these patterns is variable,
and as a result they often show up serving a secondary role,
corroborating other research results.</p>
</div>
<div class="paragraph">
<p>As will be explored,
the fundamental issues affecting EOFs are:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">O1</dt>
<dd>
<p>EOF patterns are orthogonal,
climate-associated patterns are generally not.
In the context of purely positive patterns such as precipitation,
orthogonality would imply not overlaps in the patterns.</p>
</dd>
<dt class="hdlist1">O2</dt>
<dd>
<p>All EOF patterns,
including EOF1,
generally end up representing mixtures of all the underlying signals.</p>
</dd>
<dt class="hdlist1">O3</dt>
<dd>
<p>EOF1 will often be heavily biased towards the dominant climate signal.
This makes the result often looks correct and masks the mixing.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>A typical way to define the EOF vectors is as the "eigenvectors of the cross-covariance matrix between grid points" -
as seen in North et al.
(1982).</p>
</div>
<div class="paragraph">
<p>This cross-covariance matrix means the EOF is built around the anomalies from some mean.
While the anomaly is a seemingly sensible starting point,
it actually becomes a source of an additional hard-to-resolve issue -
which we will want to avoid.
In the presence of multiple climate systems,
the mean will consist of a static mixture of all the observed patterns.
By extension,
all the calculated anomalies are effectively contaminating by all possible patterns.
For instance,
given a region under the influence of summer and winter monsoon systems,
we expect some unique spatial precipitation distributions associated with both system
(largely due to orographic effects caused by the region&#8217;s terrain).
If observed over several seasons,
any mean ends up consisting of some mixture of the two monsoons patterns.
Consequently the anomalies
(the differences between this mean and each observation)
also end up having some mixture of every observed monsoon pattern.
Since our goal is to find the original climate associate patterns,
when we work off of anomalies we are forced to look for ways to disentangle these mixed datapoints.</p>
</div>
<div class="paragraph">
<p>Fortunately we can bypass this last issue issue by reexamining the problem.
We first use an alternate,
mathematically equivalent,
formulation of the EOF.
The same exact EOF patterns can be made by doing the singular value decomposition (SVD) of the anomalies -
with the EOF vectors being the SVD&#8217;s <em>singular vectors</em>.
This allows us to entirely skip building a cross-covariance matrix.
After re-framing the EOF in terms of the SVD of the anomaly,
we propose simply dropping the anomaly requirement,
and doing a direct SVD of the normalized observations.
<a href="./paper1-normalization.html">See: SUPP Notes on Precipitation Data Normalization</a>
While this formulation presents a simpler starting point,
all the afore mentioned issues (O1..3) will still affect the SVD of the observations.</p>
</div>
<div class="paragraph">
<p>Our first goal will be to demonstrate the persisting issues using a synthetic example.
While the synthetic weather model will be extremely basic,
it will to allow us to know a-priori which climate patterns are present.
When we try to extract patterns,
using the SVD,
we can observe discrepancies with the originals we have in-hand and think about solutions.
We will then repeat the SVD on a real dataset -
the "IMERG Late" gridded precipitation dataset
<a href="./paper1-imerg.html">See: SUPP Notes on IMERG</a>.
We will look at precipitation over Peninsular Southern Thailand;
a region was chosen because of ongoing paleoclimatological work in the area.
(Tan et al. 2019)
We will not know the exact precipitation patterns a priori,
but we will know to expect summer and winter monsoon rains.
When looking at the real precipitation observations,
as well as their SVD,
we will find that they share a few important properties.
These will allow us to simplify the mathematical framing of the problem significantly.
Finally,
building on the SVD result,
we will present climate dipole bisection as a method to estimate the underlying original patterns.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_results">RESULTS</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_fig1">FIG1</h2>
<div class="sectionbody">
<div class="paragraph">
<p><span class="image"><img src="../fig/diag/fakerain.png" alt="fakerain"></span></p>
</div>
<div class="sect2">
<h3 id="_synthetic_illustrations_of_the_eofsvd_problem">Synthetic illustrations of the EOF/SVD problem</h3>
<div class="paragraph">
<p>Using a synthetic dataset allows us to not only observe the aforementioned problems
(O1 O2 O3),
but it will also give us insight in to a possible solution.
We start by creating two arbitrary patterns,
representing the two states of our climate system.
These conceptually represent two spatial patterns of rain over a region during two alternating climate systems.
Since the spatial pattern were chosen at random they will not be orthogonal to each other
(anticipating issue <strong>O1</strong>).
The purely positive patterns have a small degree of overlap.
When generating each synthetic "observation",
we first select one of the two patterns,
and then drawn from the exponential distribution to generate pixel values.
At each draw the pattern provides the mean value of the distribution.
For ease of interpretability,
the observations are arranged to mimic monthly precipitation accumulations of a monsoonal region.</p>
</div>
<div class="paragraph">
<p>First there are 8 summer-equivalent patterned observations.
This is followed by a shorter period of 4 winter-equivalent patterned observations.
We have 36 observations in total,
simulating 3 years of monthly rain.</p>
</div>
<div class="paragraph">
<p><a href="./paper1-synthetic.html">See: SUPP All Synthetic Data</a>.</p>
</div>
<div class="paragraph">
<p>We then do the SVD of the normalized observations.
It&#8217;s important to stress and reiterate,
we do not calculate anomalies.
When we look at the first two singular vectors (SV) generated by the SVD,
we immediately notice that they don&#8217;t return our original patterns.
As we had stated in <strong>O2</strong>,
the SVD&#8217;s singular vectors all end up looking like a mixtures of our original patterns.
For many climatologists it may come as a surprise that the first basis
(equivalent to EOF1)
has also been affected.
When working with the anomaly,
such mixed images are expected.
However,
when working with raw observations this is perhaps unexpected.
This mixing is a direct consequence of how the SVD is designed to extracts patterns.
He leave a detailed discussion of the causes of this mixing to
<a href="./paper1-mixing.html">SUPP SVD Mixing</a>.
For the purposes of finding a resolution we just need to know:
mixing does occur,
the mixing happens at a ratio that we do not know a priori.
Perhaps not surprisingly,
by adjusting the occurrence of each pattern in the synthetic dataset the amount of mixing in SV1 can be varied.
As a result,
we must conclude that comparing SV1 or EOF1 patterns from different sources is inadvisable.
If the patterns do not match,
we have no insight as to why.
Any differences can be due to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The actual underlying original patterns are different
(ex: change in climatology, systematic error in one data-source/time-period etc.)</p>
</li>
<li>
<p>The underlying patterns are the same,
but ratios of their occurance is different,
and hence they&#8217;re mixing differently in to SV1.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These two scenarios can not be distinguished without more information.</p>
</div>
<div class="paragraph">
<p>The next and perhaps even more glaring issue is with second Singular Vector (SV2).
The orthogonality condition of the singular vectors means SV2 is orthogonal to SV1.
What is interesting is that,
even under this constraint,
the SVD produces a different mixture of the two original patterns.
This time the resulting mixed pattern contains both negative
(blue)
and positive regions
(red).</p>
</div>
<div class="paragraph">
<p>The remaining singular vectors
(not shown)
contain virtually no sign of the patterns.
While we don&#8217;t provide a rigorous proof,
the result comes naturally when viewing the degrees of freedom of the system.
The original two signals provided two degrees of freedom in our observations.
By removing the projections of two arbitrary signal-mixtures we must remove both signals from all the observations.</p>
</div>
<div class="paragraph">
<p>The first two SVs being different mixtures of the underlying signals,
ends up being the critical piece that will allow us to build a correction.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_fig2">FIG2</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="../fig/diag/krabins.png" alt="krabins">
</div>
</div>
<div class="sect2">
<h3 id="_case_study_south_east_asian_monsoon_systems">Case Study: South East Asian monsoon systems</h3>
<div class="paragraph">
<p>We now repeat the same analysis on a real-world example in southern Thailand.
For the sake of visual clarity,
we present daily accumulations binned to pentads
(with leap days removed).
However,
daily to monthly,
at all bin sizes results are nearly identical.
Here,
unlike in the synthetic case,
we do not have concrete a priori knowledge of the climate associate patterns.
However,
we have enough of a high-level understanding of the climate to confirm the SVD/EOF problem.
Once confirmed,
we can construct a easily interpretable correction.</p>
</div>
<div class="paragraph">
<p>A preliminary visual inspection of monthly precipitation shows us that there are two distinct patterns. <strong>SUPP</strong>
The summer months have rain on the west coast,
predominantly in the northern-most part of the region.
The late fall and early winter months show rain in the south-eastern part.
These two rain patterns correspond to summer and winter monsoon systems.
The areas with the highest rainfall correspond to coastal mountains downwind of their corresponding monsoonal systems.</p>
</div>
<div class="paragraph">
<p>As in the synthetic example,
we first try to extract the underlying patterns by SVD.
The first singular vector gives us a shape that looks encouraging.
At face value it seems similar to the summer monsoon associate precipitation.
While our synthetic example showed that mixing must be happening
(issue <strong>O2</strong>)
it is not immediately apparent in this image due to a couple of reasons:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>First,
unlike in the more balanced synthetic example,
here summer monsoon rains form a dominant fraction of the annual total.
Issue <strong>O3</strong> strongly preserves a summer-monsoon-like pattern.</p>
</li>
<li>
<p>Second,
unlike our synthetic patterns,
natural patterns are typically smooth and their mixtures look physically plausible.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Here only a careful eye will note the issue with the EOF1 pattern.
There is a small intensification of precipitation on the East coast -
it does not in actuality occur in the summer months.
This distortion is only easily identified when compared to the corrected patterns.
There is also a seemingly large amount of over-water rain,
which is also due to mixing of seasonal windward precipitation.</p>
</div>
<div class="paragraph">
<p>The second singular vector,
orthogonal to the first,
shows a strong east west contrast with both positive and negative values.
Not only does this not look like either climate system,
but it is also not physically meaningful.
Since we aren&#8217;t working off an anomaly
(like in an EOF analysis),
a climate-associated pattern of precipitation should be positive.
Inverting the vector&#8217;s values doesn&#8217;t solve the issue as it would just creates other negative zones.
Just by noting this,
we can already see that it must co-occur with an other EOF
(such as EOF1)
to add up to something that does not result in negative rain.</p>
</div>
</div>
<div class="sect2">
<h3 id="_isolating_correct_patterns_by_sv_subspace_bisection">Isolating correct patterns by SV subspace bisection</h3>
<div class="paragraph">
<p>We already know,
from our synthetic example,
that our singular vectors are problematic because they in effect represent mixtures of the underlying climate signals
(<strong>O2</strong>).</p>
</div>
<div class="paragraph">
<p>Unless you are in a region with a single dominant climate system,
(that then has nothing to mix with)
the singular vectors can not be safely used as proxies for the climate.
Unfortunately,
and maybe a bit surprisingly,
there is no single simple way to differentiate a single climate region from a multi-climate one.
Such situations need to be identified by the researcher on a case-by-case basis.
For an in-depth look at the common indicators of single system regions as well as associated challenges,
please see the Marrah Plateau example in
<a href="./paper1-singleclimate.html">SUPP Single Climate Region</a>.</p>
</div>
<div class="paragraph">
<p>To isolate the climate systems we will need to assume three simplifying characteristics:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">A1</dt>
<dd>
<p>the local climate system can be approximated as a noisy system of two signals.</p>
</dd>
<dt class="hdlist1">A2</dt>
<dd>
<p>these two climate systems by and large don&#8217;t undergo any mixing.
In other words the two climates do not coocur.</p>
</dd>
<dt class="hdlist1">A3</dt>
<dd>
<p>The climate associated weather patterns scale in a near-linear fashion.
If it rains twice as much,
then it rains twice as much across the whole climate associated precipitation region.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>These assumptions were in fact implicit in the design of the synthetic example.</p>
</div>
<div class="paragraph">
<p>The critical reader will likely start to see situations where these simplifying characteristics do not hold.
Discussion of what happens when these assumptions break down is deferred until the end.</p>
</div>
<div class="paragraph">
<p><strong>MOVE TO SUPPLEMENTARY SECTION?</strong></p>
</div>
<div class="paragraph">
<p>For the moment we will treat them as good approximations.</p>
</div>
<div class="paragraph">
<p>Characteristic <strong>A2</strong> will be at the root of fixing the SVD&#8217;s climate signal mixing.
It is not noted often enough that,
when observed over a small enough region,
many climate systems implicitly form dipoles.
This describes not only the winter and summer monsoons,
but also interannual systems such as El Nino/La Nina.
There are many more such systems,
such as the Indian Ocean Dipole,
the Madden Julian Oscillations (MJO),
the Southern Annular Mode,
the North Atlantic Oscillation as well as many others.
The key characteristics they all share is that at the regional scale these are in either in a positive,
negative,
or transition state.
While some,
as will be discussed,
are described in terms of a sum of two stationary waves,
when views at small enough
(sub wavelength)
scales,
these process still adheres to this general principle.</p>
</div>
<div class="paragraph">
<p>Assuming <strong>A1</strong> to be generally true,
and building on the intuition we developed in the synthetic case,
we can now interpret the first two singular vectors as each making an estimate of two unique mixtures of the two underlying signals.
Because there are just two degrees of freedom,
certain combinations of the two SVs should give back each of the two underlying patterns
(in our case - the summer/winter monsoons)</p>
</div>
<div class="sect3">
<h4 id="_dimension_reduction">Dimension reduction</h4>
<div class="paragraph">
<p>To search for the correct SV combinations we first reinterpret our oberservations.
We reduce the problem space to two dimensions by projecting our observations on to the SV1/SV2 plane.
This can be done either by an inner product of every observation with SV1 and SV2,
or by extracting the first two columns of the SVD&#8217;s left-singular-vector matrix.</p>
</div>
<div class="paragraph">
<p><strong>MAYBE DENORMALIZE HERE?</strong></p>
</div>
<div class="paragraph">
<p>The discarded SVs
(SV3 SV4 ..)
in aggregate form a noise-like factors.
They can be used to estimate an upper bound on the errors in the SV1/SV2 projections.
These error bounds can then be used to help refine our final pattern estimates.
However,
since it is tangential to the main thrust behind climate dipole bisection we leave this to a supplementary section.</p>
</div>
<div class="paragraph">
<p><a href="./paper1-erroranalysis.html">SUPP Error Analysis</a>.</p>
</div>
<div class="paragraph">
<p>Looking at our observations in this reduced 2D subspace,
we immediately see the effect of the second simplifying assumption <strong>A2</strong>.
Observations generally either belong to one or the other dipole phase.
Hence the climate dipole causes most observations to form along two lines through the origin.
One grouping is dominated by summer (yellow) pentads while the other winter (blue/purple) pentads. <strong>OR AM I GOING TO DO MONTHLY???</strong>
The two vectors,
along which the observations are aligning,
can also be interpreted as each representing a ratio of SV1 and SV2.</p>
</div>
<div class="paragraph">
<p>From our synthetic example we saw the SVs came out as mixtures of the original climates patterns.
Now we are seeing the inverse process;
the ratios of SV1 and SV2 that represent each alignment-vector will serve to "unmix" the singular vectors and recover the patterns.</p>
</div>
</div>
<div class="sect3">
<h4 id="_estimating_sv_mixtures">Estimating SV mixtures</h4>
<div class="paragraph">
<p>To find these climate associate vectors we use a procedure akin to Otsu&#8217;s method -
from computer vision
(Otsu 1979).
We first subdivide the 2D subspace along all possible dichotomies.
We then find which bisecting line minimizes the total variance of both halves;
ensuring that both halves form two tight groupings.
Since each observation corresponds to a mixture of SV1 and SV2,
the variance reduction is in fact done in angular space.
The previously mentioned noise-like singular vectors
(SV3 SV4 ..)
can provide us with angular errors;
allow one to apply an inverse-variance weighting.
The error estimation and weighting is explained in greater detail in
<a href="./paper1-erroranalysis.html">SUPP Error Analysis</a>.
Once the optimal bisector/dichotomy has been selected
(red dashed line),
the angular mean of each half gives us the SV1 SV2 mixture to reconstruct the climate-associated pattern.
(black dashed line).</p>
</div>
<div class="paragraph">
<p>With reconstructed patterns in-hand,
we see if they correspond to what we visually observed in the original data.
Indeed,
top and bottom mixtures closely correspond what we see in the summer and winter months.
Note how the previous artifact we saw in SV1,
with spurious rains on the East coast,
has completely vanished.
Also notice how SV1&#8217;s positive offset is gone.
We now get near-zero rain over downwind ocean sectors.
Most importantly, all patterns are positive.
For completeness,
the procedure and results are also shown for the synthetic case.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_applications">Applications</h3>
<div class="sect3">
<h4 id="_climate_patterns">Climate Patterns</h4>
<div class="paragraph">
<p>The resulting patterns can serve as the basis for further research.
Unlike EOF1 patterns,
climate dipole bisected patterns can be compared between datasets.</p>
</div>
<div class="paragraph">
<p>The patterns have so far been interpreted as a static repeating shapes.
However,
on longer term time scales one anticipates reconfigurations in the climatology and subtle evolution of the shape over time
(ex: wind direction)
It is now feasible to comparing changes in climate patterns over different time intervals.
Additionally,
patterns can serve as sources of truth for validating climate models.
Discrepancies,
if found,
could be avenues for further investigation.</p>
</div>
</div>
<div class="sect3">
<h4 id="_climate_indices">Climate Indices</h4>
<div class="paragraph">
<p>Coming back to our original thesis.
Maybe more importantly,
these patterns allow us to objectively estimate the presence of climate in past and future observation.</p>
</div>
<div class="paragraph">
<p>Reflecting on the prior art of dipole climate indeces,
we first observe that it&#8217;s at times possible to construct a properly tuned region where EOF1
(which is done on an anomaly and not raw data)
gives a workable estimate of both climate dipoles simultaneously.
It&#8217;s not uncommon for the dipole to form a mirrored pair of anomalies.
For instance,
when looking at precipitation,
wind reversals,
in combination with orographic effects,
will often creates mirrored anomalies across mountain ranges
(where the rain shadow flipping sides).
In our case study region,
with some adjustments,
the anomaly could be made to go high/low in the northwest and low/high in the southeast.
However,
we must note that such an EOF1 would require a tuned region and validation by other heuristics.
We can not count on this being true for any arbitrary region.</p>
</div>
<div class="paragraph">
<p>Our climate dipole bisection avoids the serendipity of these extra symmetry requirements.</p>
</div>
<div class="paragraph">
<p>We not only don&#8217;t need to characterize the climate or construct heuristics,
but as long as we ensure that there is a dipole and dipole driven spatial inhomogeneity
(such as orographic effects)
we can generate correct dipole indeces.
While not every region is amenable
(such as monsoon precipitation over open ocean),
this great widens the net on where climate systems are observable.
It further opens the door to potentially observe climate through regional patches,
allowing one to construct a synoptic scale understanding of climate systems.</p>
</div>
<div class="paragraph">
<p>To build the final dipole indeces we simply need to project observations on to our two patterns.
We use the bisecting line (red dashed line Fig 2) to classify which climate system phase each observation belongs to.
We then project each observation on to their respective half&#8217;s climate pattern.
The projection should be done directly -
ie. an inner product of the pattern and data.
This is because the resulting climate patterns do not form a true physical basis,
such as one produced in a Rotated EOF method.
This makes non-orthogonal projections inappropriate in this scenario.
A more in depth exploration is left to
<a href="./paper1-projection.html">SUPP CDB as EOF Rotation and Projections</a>.</p>
</div>
<div class="paragraph">
<p>The projections' error bounds can be estimated with the previously mentioned projection errors.
See
<a href="./paper1-erroranalysis.html">SUPP Error Analysis</a>.</p>
</div>
<div class="paragraph">
<p><strong>MAYBE DENORMALIZE EARLIER</strong>
Once the index is constructed,
to have the index trend with precipitation volume,
index values can generated on de-normalized observations.
In rare cases with an extremely weak climate phase,
the denomalized observations can squash the weaker phase making the negative phase hard to observe.
<strong>SUPP</strong> <strong>HAINAN</strong></p>
</div>
<div class="paragraph">
<p>It&#8217;s important to note that,
denormalized or not,
the two resulting climate indices are not comparable.
Unlike a tuned EOF1 region which operates with one pattern,
here we have two separate patterns that are being projected on.
As a result,
one can not make statements such as
"This year&#8217;s summer monsoon was 20% stronger than the winter monsoon".
EOF1 based climate indices implicitly make such comparisons possible,
but the conclusions are likely erroneous and highly dependent on the selected region.
With two separate patterns such comparisons become explicitly not possible.</p>
</div>
<div class="paragraph">
<p>To see a daily climate index,
see <strong>SUPP</strong>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_discussion">Discussion</h3>
<div class="paragraph">
<p>Using a synthetic example,
we started with a typical EOF-like analysis and observed the resulting issues.
We reformulated the EOF which allowed us to skip the anomaly calculation,
leaving us with an SVD of normalized observations.
On visual inspection,
we saw that the singular vectors were preserving climate patterns in a mixed state.
Then,
through a set of simplifying assumptions,
we formulated a simple physically interpretable method for finding how to combine the singular vectors to extract the original patterns back out.</p>
</div>
<div class="paragraph">
<p>The main points of failure can be framed as breakdowns in our simplifying assumptions.
Some degree of breakdown in each assumption
(A1 A2 A3)
is always present.</p>
</div>
<div class="paragraph">
<p>An extensive discussion of the different failure modes is left to a supplementary section:
<a href="./paper1-breakdown.html">SUPP Breadowns in CDB Assumptions</a>.</p>
</div>
<div class="paragraph">
<p>As a demonstration,
we explore using this method on sea surface temperature
(see: <strong>SUPP South China Sea SST</strong>).
While the results present a clear improvement over the EOF,
they also have some clear problems,
and the final patterns are visibly suboptimal due to breakdowns in the assumptions.</p>
</div>
<div class="paragraph">
<p>Here we will only stress two particularly important considerations.</p>
</div>
<div class="paragraph">
<p>The first is the importance of selecting small regions.
The original EOF methods were developed at a time where extremely high resolution regional data,
such as IMERG,
were less common.
Notwithstanding the increased availability of high resolution data,
we continue to see large,
continent scale,
regions analyzed all at once.
This presents numerical challenges,
since the SVD in effect describes observations as sums of static patterns.
A dynamic process,
such a wave/front crossing the observed region,
present a numerical complication as it does not manifest as a single extractable pattern.
In such scenarios the decomposition typically degenerates waves to sums of phase-offset stationary sigmoids.
Though in cases such as the MJO,
such modes form a central part of how the climate system is defined and observed,
in many situations they are difficult to interpret as they intermix with static patterns.
Fortunately this issue can often be mitigated because at a small enough scales
(fraction of the wavelength)
wave-like structures will often look like dipoles.
As the wave crest and trough goes through the region,
we once again have positive, negative and transition states.
This often looks like a pair of alternating static images that vary in intensity.
This stresses the need to select regions that are as small as practical.
A region&#8217;s minimum size is dictated by two factors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The regional topography&#8217;s ability to drive distinct patterns in each phase of the dipole.</p>
</li>
<li>
<p>The lower value between "number of observation" and "number of points/pixels" dictates the total number of singular vectors.
This in turn affects our ability to separate signal from noise.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We will note here that the Southern Thailand case study was not tuned to a minimal region size of this sort -
as our objective was to illustrate climate pattern extraction.</p>
</div>
<div class="paragraph">
<p>The second issue we would like to address is that of coocurrant tertiary climate systems.
(We have not yet been able to identify any non-cooccurring tertiary systems ie. a climate tripole).
Other systems will naturally coincide with the dipole under observation.
However,
even after searching,
we have found it difficult to identify regions where such tertiary systems are very clearly visible.
We surmise that such systems have a tendency to be significantly weaker than the dominant dipole.
For a concrete example it suffices to look at our case study in Southern Thailand.
Here we know a priori that there is both a short-period MJO system as well an the interannual ENSO signal.
However,
both are not easy to spot in the raw observation.
Nonetheless,
we can with confidence say that must be skewing the climate patterns somehow -
even if only by a little.
Through a careful look at the daily precipitation climate index,
we do manage to detect the MJO as an intermittent index reversal.
See <strong>SUPP</strong>
The affected/skewed observations likely constitute a small minority of the data.
From the perspective of the climate bisection method,
highly skewed patterns will often map poorly to the SV1 SV2 subspace.
If one uses estimated error bounds to calculate angular averages
(as described in <a href="./paper1-erroranalysis.html">SUPP Error Analysis</a>)
then skewed observations influence the final averages a lot less.</p>
</div>
<div class="paragraph">
<p>While we do not present any concrete evidence,
we surmise these systems have a negligible impact on the resulting SVs -
and by extension the final patterns.
However,
a holistic framework for accounting for tertiary signals will be an area of future work.</p>
</div>
<div class="paragraph">
<p>With these caveats in mind,
notwithstanding the different possible breakdowns in our assumptions,
and even in the presence of severe skewing,
in our testing climate dipole bisection still consistently provides a clear improvement over raw EOF vectors.
The EOF vectors effectively always manifest as a mixture of the patterns we&#8217;d actually like to be observing;
and the second EOF&#8217;s orthogonality constraint almost guarantees it will miss the mark.
Given this starting point,
climate dipole bisection presents a clear,
physically motivated and mathematically simple correction.</p>
</div>
<div class="paragraph">
<p>There are many alternate methods for trying to correct the EOF.
These are broadly called "EOF rotations" (Richman 1986),
and this class of methods typically try to bring SVD rotation methods from applied mathematics and apply them to the EOF.
Not only do they persist in being built around the anomaly
(as opposed to raw observations),
but they end up applying methods that have their origin in solving what are fundamentally much more complicated problems;
these are scenarios where signals from different sources are cooccurring in a background of noise.
Such systems are common in the fields of electrical engineering,
acoustics and elsewhere.
In those domains,
the SVD allows things such as denoising and compression,
and rotations allow one to construct more favorable basis vectors.
Independent Component Analysis is alternate approach to construct a minimal basis.
It leverages statistical properties of the signals to estimate the original "unmixed" signals,
with very compelling results when applied to climate systems.
However,
as we&#8217;ve illustrated,
climate associate patterns,
when observed over small regions,
sit in a simpler subset of the broader realm of pattern extraction problems.
Once we assume a small set of properties,
the non-cooccurance of climate dipoles creates a special case where pattern extraction is greatly simplified.
Furthermore,
under these assumption,
framing the solution as a rotations of the EOFs
(to form a "corrected" basis)
becomes problematic.
Since the two dipole phases cannot undergo mixing,
such a basis is effectively degenerate.
Under our assumptions,
lying anywhere off-axis in such non-orthogonal basis does not correspond to any climatological process.
Hence projecting observations in to such a non-orthogonal subspace presents a deceptive representation of the climate system.
<a href="./paper1-projection.html">SUPP CDB as EOF Rotation and Projections</a>.
Furthermore,
even in situations where there is a breakdown in the assumptions,
and climate system do mix or coocur
(such as tertiary climate systems),
such basis vectors are still likely to be problematic.
Unlike acoustic or electrical signal,
many climate parameters such as precipitation are unlikely to mix in a linear/additive fashion.
When such scenarios need to be addressed,
linear methods such as EOF/SVD,
as well as climate dipole bisection,
are not sufficient in isolation.
Such cooccuring mixing systems will be the scope of future work.</p>
</div>
<div class="paragraph">
<p>Because the method as presented has no tuning parameters or climate system specific considerations,
the resulting patterns have the impartiality and repeatability that we hope will allow it to become a consensus result -
which can form the starting point for further research in regional climate systems</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_references">References</h2>
<div class="sectionbody">
<div class="paragraph">
<div class="title">PNAS paper about Klang Cave</div>
<p>Tan, L., Shen, C.-C., Löwemark, L., Chawchai, S., Edwards, R. L., Cai, Y., Breitenbach, S. F. M., Cheng, H., Chou, Y.-C., Duerrast, H., Partin, J. W., Cai, W., Chabangborn, A., Gao, Y., Kwiecien, O., Wu, C.-C., Shi, Z., Hsu, H.-H., &amp; Wohlfarth, B. (2019). Rainfall variations in central Indo-Pacific over the past 2,700 y. Proceedings of the National Academy of Sciences, 116(35), 17201–17206. <a href="https://doi.org/10.1073/pnas.1903167116" class="bare">https://doi.org/10.1073/pnas.1903167116</a></p>
</div>
<div class="paragraph">
<div class="title">Talks about close EOF vectors mix due to closes singular values</div>
<p>North, G. R., Bell, T. L., Cahalan, R. F., &amp; Moeng, F. J. (1982). Sampling Errors in the Estimation of Empirical Orthogonal Functions. Monthly Weather Review, 110(7), 699-706. <a href="https://doi.org/10.1175/1520-0493(1982)110&lt;0699:SEITEO&gt;2.0.CO;2" class="bare">https://doi.org/10.1175/1520-0493(1982)110&lt;0699:SEITEO&gt;2.0.CO;2</a></p>
</div>
<div class="paragraph">
<div class="title">Otsu&#8217;s Method</div>
<p>Otsu, N. (1979) A Threshold Selection Method from Gray-Level Histograms. IEEE Transactions on Systems, Man, and Cybernetics, vol. 9, no. 1, pp. 62-66. <a href="https://doi.org/10.1109/TSMC.1979.4310076" class="bare">https://doi.org/10.1109/TSMC.1979.4310076</a></p>
</div>
<div class="paragraph">
<div class="title">Overview of the different EOF Rotation methods</div>
<p>Richman, M.B. (1986), Rotation of principal components. J. Climatol., 6: 293-335. <a href="https://doi.org/10.1002/joc.3370060305" class="bare">https://doi.org/10.1002/joc.3370060305</a></p>
</div>
<div class="paragraph">
<div class="title">Nino 3.4</div>
<p>Trenberth, K. E. (1997). The Definition of El Niño. Bulletin of the American Meteorological Society, 78(12), 2771-2778. <a href="https://doi.org/10.1175/1520-0477(1997)078&lt;2771:TDOENO&gt;2.0.CO;2" class="bare">https://doi.org/10.1175/1520-0477(1997)078&lt;2771:TDOENO&gt;2.0.CO;2</a></p>
</div>
<div class="paragraph">
<div class="title">This has the grid map of the onset and withdrawls</div>
<p>Wang, B., &amp; LinHo, . (2002). Rainy Season of the Asian–Pacific Summer Monsoon. Journal of Climate, 15(4), 386-398. <a href="https://doi.org/10.1175/1520-0442(2002)015&lt;0386:RSOTAP&gt;2.0.CO;2" class="bare">https://doi.org/10.1175/1520-0442(2002)015&lt;0386:RSOTAP&gt;2.0.CO;2</a></p>
</div>
<div class="paragraph">
<div class="title">Changes in NAO EOF patterns over different periods</div>
<p>Werb, B. E., &amp; Rudnick, D. L. (2023). Remarkable changes in the dominant modes of north Pacific sea surface temperature. Geophysical Research Letters, 50, e2022GL101078. <a href="https://doi.org/10.1029/2022GL101078" class="bare">https://doi.org/10.1029/2022GL101078</a></p>
</div>
<div class="paragraph">
<p><a href="https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2022GL101078" class="bare">https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2022GL101078</a></p>
</div>
<div class="paragraph">
<div class="title">Also two patterns from two periods compared</div>
<p>Yeh, S., Kang, Y., Noh, Y., &amp; Miller, A. J. (2011). The North Pacific Climate Transitions of the Winters of 1976/77 and 1988/89. Journal of Climate, 24(4), 1170-1183. <a href="https://doi.org/10.1175/2010JCLI3325.1" class="bare">https://doi.org/10.1175/2010JCLI3325.1</a></p>
</div>
<div class="paragraph">
<p><a href="https://journals.ametsoc.org/view/journals/clim/24/4/2010jcli3325.1.xml" class="bare">https://journals.ametsoc.org/view/journals/clim/24/4/2010jcli3325.1.xml</a></p>
</div>
<div class="paragraph">
<div class="title">Comparing EOFs as part of their analysis (maybe model vs measurement?)</div>
<p>Yeager, S., &amp; Danabasoglu, G. (2014). The Origins of Late-Twentieth-Century Variations in the Large-Scale North Atlantic Circulation. Journal of Climate, 27(9), 3222-3247. <a href="https://doi.org/10.1175/JCLI-D-13-00125.1" class="bare">https://doi.org/10.1175/JCLI-D-13-00125.1</a>
<a href="https://journals.ametsoc.org/view/journals/clim/27/9/jcli-d-13-00125.1.xml" class="bare">https://journals.ametsoc.org/view/journals/clim/27/9/jcli-d-13-00125.1.xml</a></p>
</div>
</div>
</div>
</div>
</body>
</html>