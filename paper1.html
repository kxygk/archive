<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.20">
<meta name="author" content="George Kontsevich">
<title>Paper1</title>
<style>
@import '../web/kxygk.css';

html {
margin: 0;
overflow-x: hidden;
}
body {
margin-left: 0px;
margin-right: 0px;
margin-left: 5vw;
margin-right: 5vw;}
#table-of-contents {display: none} /* disable for now.. till I have a better plan */
.listingblock,pre.src {
margin-left:  -5vw;
margin-right: -5vw;
font-family: monospace;
font-size: 100%;
background: #FFFFEE;
overflow: auto;
position: static;
border-top: 1px solid  #e5e5d6;
border-bottom: 1px solid  #e5e5d6;
}
pre.src-org {
color: red;
background: #FFFFFF;
}
blockquote {
width: 100%;
padding-left: 0.5em;
border-left: solid;
border-left-width: 4px;
border-left-color: grey;
background-color: #eefaf6; /*#f1ffee;*/
margin: 0;
.org-center {
text-align: center;}
}
svg { /* newer inline SVGs */
width: 100vw;
overflow: hidden;
height: auto;
margin-left: -5vw;
margin-right: 0;
}
/*.org-svg {
width: 100vw;
display: block;
margin-left: auto;
margin-right: auto;
}*/

img {
    display:flex;
max-width: 100%;
height: 100%;
max-height: 33vh;
vertical-align: middle;
width: auto;
margin: auto;
}
ul {
list-style-type: circle;
padding-left: 1.5em;
border-left: solid;
border-left-width: 1px;
border-left-color: grey;}
h1 {color: #596060;}
h2 {
    color: black;
font-style: italic;
    padding-top: 0.5em;
    border-bottom: 4px solid  #aaaaaa;}
h3 {color: black;
border-bottom: 2px dotted  #aaaaaa;}
b, i{
font-family: serif ;}
sup { /* fixes line spacing issues due to superscripts */
font-size: 0.8em;
line-height: 0;
position: relative;
vertical-align: baseline;
top: -0.5em;
}
sub { /* if these are missing then lines with subscripts take up more space */
font-size: 0.8em;
line-height: 0;
}
.title {
font-weight: bold;
}
dt {
font-weight: bold;
}
td p, dd p, li p{
    margin: 0;
}
ul, p{
    margin-top: 0;
}
.sidebarblock{
    background:#f3f3f2;
}
.float-group::before,.float-group::after{content:" ";display:table}
.left{float:left!important}
.right{float:right!important}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
.scrollbox{
    white-space: nowrap;
    overflow-x: scroll;
    scroll-snap-type: x mandatory;
}
.scrollbox img{
    height:auto;
    width:auto;
    max-width: 70vw;
    max-height: 60vh;
    vertical-align: bottom;
    scroll-snap-align: start;
}
video{
    height:auto;
    width:auto;
    max-width: 30vw;
    max-height: 30vh;
}
.content{
    height: 100%;
}
.imageblock{
    height: 100%;
}
.flexbox > .content{
    display: flex;
    justify-content: center;
    height: 33vh;
}
@media (min-width:60rem) {
.sectionbody{
    column-count:2;
    hyphens: auto;
}
@media (min-width:90rem) {
.sectionbody{
    column-count:3;
}
@media (min-width:120rem) {
.sectionbody{
    column-count:4;
}

</style>
<meta name="robots" content="noindex">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains("stemblock")) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="../MathJax/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</head>
<body class="article">
<div id="header">
<h1>Paper1</h1>
<div class="details">
<span id="author" class="author">George Kontsevich</span><br>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_abstract">Abstract</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The interplay between recurring atmospheric processes and local topography creates regular observable climatic phenomena.
We present a novel method for analyzing the spatial distribution of atmospheric parameters at the mesoscale which will allows for the extraction of a pair of underlying climate-associated shapes.
The method builds on the singular value decomposition (SVD) and corrects for several deficiencies of a typical empirical orthogonal function (EOF) analysis.
The extracted shapes act as unique fingerprints that allow one to observe climate without having to characterize it,
without needing to understand any of its dynamics,
and without building any heuristics or adjusting tuning parameters.
Key to making the EOF correction is recognizing that a large fraction of climate phenomena come in non-coocurring pairs.
Systems such as the Summer/Winter Monsoons,
El Nino / La Nina and the positive and negative phases of many climate systems are all typically in one of two modes.
In effect the presence of one climate state precludes the occurrence of the other.
As a result of this bistability,
when using the SVD to reduce the measured climate parameters to two dimensions we observe clustering around two linear combinations of the basis vectors.
These two combinations can be found using a variance minimizing search (Otsu&#8217;s method) that terminates at an optimal solution and represent a simple mixture of the first two singular vectors.
The mixtures' associated shapes can then be used to measure the presence of the climate phenomena in the original data to build a rolling two state climate index.
We present several examples using the IMERG precipitation dataset,
the ERA5 precipitations model estimates and a small synthetic data example.
An accompanying program for reproducing the analysis is provided.</p>
</div>
<div class="ulist">
<div class="title">TODO:</div>
<ul>
<li>
<p>Find something better than the ratio. Maybe work in radians?</p>
</li>
<li>
<p>Updated current centroids with weighted average centroids once errors are in place</p>
</li>
<li>
<p>ERA5 plots</p>
</li>
<li>
<p>Other case studies&#8230;&#8203; Daily examples, Diurnal examples.. etc.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Climate systems,
such at the monsoons or El Nino/La Nina aquired their names when people native to a region note a recurring weather phenomena and ascribe it a name.
The typical modern approach is to characterize the causes and signatures associated with a particular recurring climate system.
However the original methodology,
of pattern recognition comes naturally to the untrained eye.
Arguably it still presents several distinct advantages.
Chief among them are its generality and simplicity.
Pattern recognition as applied in the atmospheric sciences has chiefly been used using empirical orthogonal function (EOF) analysis.
This is typically done by doing a singular value decomposition (SVD) of some climatological parameter&#8217;s anomaly from a mean.
The SVD works in an iterative fashion, calculating the induced matrix norm of the dataset, removing it from the data and then repeating the process.
For a single signal system this produces the best approximation of the underlying signal.
However climate records often have multiple climate signals and results are often not meeting expectations.
Often the first EOF is used and subsequent ones are discarded.
The most critical issues affecting the resulting patterns and their interpretations are as follows:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">O1</dt>
<dd>
<p>EOF patterns are orthogonal,
climate-associated patterns are generally not.</p>
</dd>
<dt class="hdlist1">O2</dt>
<dd>
<p>All EOF patterns,
including EOF1,
will represent a mixture of all underlying signals</p>
</dd>
<dt class="hdlist1">O3</dt>
<dd>
<p>EOF1 is biased towards the strongest signal</p>
</dd>
<dt class="hdlist1">O4</dt>
<dd>
<p>Changes in EOF1 and EOF2 over time often make it seem like climate phenomena have some sort of phase-lag,
but this is in fact an artifact due to poor climate pattern separation.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The reliance on the anomaly is another potential source of issues,
especially if there no discernable mean structure to be removed.
A mean will contain a mixture of all the regional climate patterns - in some ratio that is not know a priori.
Removing the mean to calculate an anomaly in effect introduces a constant amount of each climate pattern to all time points.
Meanwhile the climatological patterns actually manifesting at each time point will be vary in intensity.
Disentangling the unknown constant factors and the varying patterns would greatly complicate the analysis,
so to sidestep this issue we confine ourselves to the using the SVD of the original data directly.
This means that instead of EOF1, EOF2, .. etc. we will use the singular vectors SV1 SV2 .. etc.</p>
</div>
<div class="paragraph">
<p>All the aforelisted issues hold just as well for the SVD as the EOF.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_materials">Materials</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>We first illustrate the critical issues with EOF-like analyses using synthetic data and a know a-priori pattern.
These are meant to provide a rough approximation of precipitation patterns as seen in the subsequent sections.
Knowing the ground truth allows us to evaluate results objectively.</p>
</li>
<li>
<p>For the main case study we then look at a Peninsular Southern Thailand.
The top of the Malay Peninsula is climatologically challenging as it&#8217;s subject to two distinct monsoon systems.
The summer monsoon brings moisture from the Indian Ocean and drives precipitation for most of the year,
while a much shorter winter monsoon system brings moisture from the East - the South China Sea and the Gulf of Thailand.
There is also a short "dry season" at the beginning of the year that is modulated by the inter-annual ENSO system.</p>
</li>
<li>
<p>We use gridded precipitation data as provided by the IMERG Late dataset (monthly bins) to help us demonstrate how our method yields a clear improvement in climate pattern extraction in real-world conditions.
Modern high density/dimension mesoscale data is essential for pattern extraction.
At large/synoptic scales climate phenomena do not take effect simultaneously across the whole region of interest.
This causes larger fractions of the observation time having incomplete/smeared climate associated patterns.
As a result it becomes more difficult to isolation fixed patterns and energy "leaks" into secondary modes.
In contrast,
small/mesoscale regions will have faster climate system onset and withdrawl.
For instance across the observed southern Thai geogrid the monsoon onset will happen over the course of just several days. (REF)</p>
</li>
<li>
<p>The IMERG Final dataset is not used b/c the rain-gauge normalization introduces stenciling artifacts (SHOW SUPPLEMENTARY FIGURE???)</p>
</li>
</ul>
</div>
<div class="dlist">
<div class="title">Supplementary sections explore:</div>
<dl>
<dt class="hdlist1">The Great Rift Valley</dt>
<dd>
<p>A region with semi non seasonal climate signals.</p>
</dd>
<dt class="hdlist1">Marrah Mountains (Sudan)</dt>
<dd>
<p>A region with one climate phenomena and the breakdown in one of the EOF assumptions.</p>
</dd>
<dt class="hdlist1">Java Island</dt>
<dd>
<p>Diurnal cycles with large errors and less stationary patterns</p>
</dd>
<dt class="hdlist1">ERA5 reanalysis precipitation</dt>
<dd>
<p>The method as used to validate climate model output</p>
</dd>
<dt class="hdlist1">IMERG Final Result</dt>
<dd>
<p>Showing artifacts caused by numerical normalization procedures</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_synthetic_illustrations_of_the_eof_problem">Synthetic illustrations of the EOF problem</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To observe the result of the SVD we will work off of a known pattern.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../fig/imrg/pattern1.svg" alt="pattern1">
</div>
<div class="title">Figure 1. Generation Pattern</div>
</div>
<div class="paragraph">
<p>We then perturb this pattern to generate a test dataset. These will represent an idealized climate induced precipitation pattern over a region. To make the example more concrete we imagine it as 12 monthly precipitation accumulations. Each row representing a year of rain</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../fig/imrg/synth1patt/precipitation-all.svg" alt="precipitation all">
</div>
<div class="title">Figure 2. 3 Years of simulated gridded monthly precipitation over a region. One grid per month, one year per row.</div>
</div>
<div class="paragraph">
<p>The SVD in-effect performs a linear weighted sum of these input image such that we get a nice approximation of the underlying <code>t</code> shaped pattern.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../fig/imrg/synth1patt/sv-0.svg" alt="sv 0">
</div>
<div class="title">Figure 3. First Singular Vector (SV1)</div>
</div>
<div class="paragraph">
<p>The algorithm selects weights such that they maximizes the energy of the what is in-effect a weighted average. The constraint (so that you can&#8217;t pick arbitrarily large weights) is that the vector of your weights is of unit length. Such a sum effectively gives more weight to data that has higher values and data that has higher signal to noise ratios - as the data will effectively "stack up" producing a larger sum. The result should be superior to a straight average of all the data, though in our experience the results are quite similar</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../fig/imrg/synth1patt/average.svg" alt="average">
</div>
<div class="title">Figure 4. Average of all the data</div>
</div>
<div class="paragraph">
<p>Note the blue color indicates negative values - a characteristic of most SVD numerical routines is that the first singular vector will be negative (negative weights).
The result could be safely inverted.
This would be equivalent to inverting the weight values.
However, for simplicity I will keep the output vectors unaltered (as produced by the Intel MKL SVD routine).
This means that while the singular vectors are not unique,
because they are unit length,
they are numerically repeatable can only take on two different values.</p>
</div>
<div class="paragraph">
<p>We then expand the problem to a two pattern system.
We have taken the previous data set and substituted the last four months with a second pattern.
This serves to approximate what we will see in the first case study.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../fig/imrg/pattern2.svg" alt="pattern2">
</div>
<div class="title">Figure 5. Second Generation Pattern</div>
</div>
<div class="paragraph">
<p>This will act as a synthetic secondary winter climate pattern. We want to observe how a secondary signal affects our SVD. As stated in issues O1, the pattern is arbitrary and not orthogonal to the first.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../fig/imrg/synth2patt/precipitation-all.svg" alt="precipitation all">
</div>
<div class="title">Figure 6. 3 Years of simulated gridded monthly precipitation over a region, now with two patterns</div>
</div>
<div class="paragraph">
<p>However before we even come to the orthogonality issues, SV1 already looks problematic.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../fig/imrg/synth2patt/sv-0.svg" alt="sv 0">
</div>
<div class="title">Figure 7. First Singular Vector (SV1)</div>
</div>
<div class="paragraph">
<p>The dominant signal from before is the most prominent feature, but the secondary pattern is also visible - illustrating issue O2 and O3.
This should dispel the myth that EOF1 (or SV1) is somehow a safe basis b/c it is no affected by the orthogonality constraint.
The orthogonality constraint naturally makes things even worse for SV2 and it is even more difficult to visually interpret.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../fig/imrg/synth2patt/sv-1.svg" alt="sv 1">
</div>
<div class="title">Figure 8. Second Singular Vector (SV2)</div>
</div>
<div class="paragraph">
<p>SV2 is orthogonal to SV1 due to the iterative nature of the SVD algorithm.
It had first removed SV1 from the dataset before computing SV2.
Hence all the remaining data was orthogonal to SV1 and therefore their linear combination (SV2) is also orthogonal.
As a result SV2 is even more strange and unrelated to the underlying signals.
This is highlighting issue O2 - that all singular vectors are actually representing different mixtures of all the signals.
Therefore,
most importantly,
none can be directly interpreted as climate indicators (outside the simple and yet common case of only one climate system).</p>
</div>
<div class="paragraph">
<p>A detailed mathematical treatment of why all EOF vectors end up being mixtures is outside the scope of this paper.
However,
in short,
this is a byproduct of how the weights (the singular values) are assigned.
At face value,
adding in a secondary signal seems to run counter to the goal of maximizing the energy of the sum.
However,
the root cause is that the maximization is done by maintaining the 2-norm of the weights at 1.0.
The weights do not add up to 1.
Instead this can be restated as: the weights form a "unit vector" ie. <strong>the quadrature sum</strong> of the weights is equal to <code>1.0</code>.
The quadrature sum means that counterintuitively the sum of weights is not constant.
All else being equal,
spreading weights out actually makes their direct sum a higher value.
This is most easily illustrated by looking at the logical extremes.
If all weight were assigned to one data point and all other weights were set to zero,
then the sum of weights would equal <code>1.0</code>.
By contrast an even spread of weights across all data gives <code>N</code> weights of <code>1/sqrt(N)</code> and <code>N/sqrt(N) &gt; 1.0</code> for all values of <code>N</code>.
The end result is that secondary signals always get small weights assigned to them because though they don&#8217;t sum constructively with the dominant signal,
it does in effect increases the total sum of all the weights.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../fig/imrg/synth2patt/sv1sv2-2scale.svg" alt="sv1sv2 2scale">
</div>
<div class="title">Figure 9. How SV1 and SV2 change over time</div>
</div>
<div class="paragraph">
<p>Lastly we take a quick look at how SV1 and SV2 evolve over time. This goes to highlight issue O4. There is some cyclic pattern that seems aparent and it is easy to misinterpret this as indicative of two coupled climate processes at work. However, we a priori know here that the two climate systems are entirely decoupled. This false cycles/coupling will become even more aparent in the case studies.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_case_study_south_east_asian_monsoon_systems">Case Study: South East Asian monsoon systems</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We work off of a real example in southern Thailand so that the EOF problems can be confirmed. Once confirmed we can construct a easily interpretable correction that produces patterns with a much higher fidelity to those we observe in the raw data.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../fig/imrg/krabi/monthly/precipitation-all.svg" alt="precipitation all">
</div>
<div class="title">Figure 10. Annual cycles 2011 through 2021. One year from January to December per row. The middle of the year shows consistent summer monsoon rains on the west coast. Sporadic east coast rains towards the end of the year</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../fig/imrg/krabi/monthly/precipitation-all-normalized.svg" alt="precipitation all normalized">
</div>
<div class="title">Figure 11. A normalized version (to the dataset&#8217;s global max)&#8230;&#8203; maybe better?</div>
</div>
<div class="paragraph">
<p>IMERG data allows us to observe monthly precipitation of the region at high resolution. Visually we observe that rainfall comes in two distinct patterns. The summer months have rain on the west coast, predominantly in the northern most sections. The late fall and early winter months show rain in the south eastern section. These two rain patterns correspond to two monsoon system. At a high level the pattern represent the end result of a complex interplay between the local topography and the synoptic scale atmospheric conditions. In this case the areas of most rainfall correspond to coastal high mountains upwind in their associated monsoonal systems.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../fig/extr/etopo2022-krabi.jpg" alt="etopo2022 krabi">
</div>
<div class="title">Figure 12. ETOPO Global Relief Model</div>
</div>
<div class="paragraph">
<p>While the patterns are readily apparent in the monthly averages, we would like to extract the patterns in an objective manner. We&#8217;d like to avoid manual picking "monsoon months". We also don&#8217;t want to build any threshold heuristics based on past statistics <strong>(Rainy Season of the Asian Pacific Summer Monsoon - Bin Wang)</strong>. nor do we want to assume any a priori knowledge of what is a monsoon and what atmospheric conditions are associated with it. As a first attempt to observe the climate induces rain patterns, we perform a singular value decomposition on monthly rainfall. For the subsequent analysis we use a ten year period from 2011 up till 2022 - for a total of 120 monthly snapshots.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../fig/imrg/krabi/monthly/sv-0.svg" alt="sv 0">
</div>
<div class="title">Figure 13. First Singular Vector (SV1)</div>
</div>
<div class="paragraph">
<p>The first singular vector gives us a shape that looks similar to the west coast precipitation associate with the summer monsoon. Often in an EOF anaylsis one would stop at this point as the result doesn&#8217;t have obvious issues. The values are all negative (blue) but the vector could be inverted to make it more directly interpretable. While we know signal mixing must be happening due to issue O2, it is not immediately apparent due to a couple of reasons. First, the summer monsoon dominates the annual rainfall totals and therefore issue O3 preserves the pattern. Second, unlike in a simple synthetic example (SUPP1) natural patterns are typically much smoother. As a result their mixtures do not make large glaring artifacts. However, a careful eye will note that there is an intensification of precipitation on the East coast which we do not see in the summer months!</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../fig/imrg/krabi/monthly/average.svg" alt="average">
</div>
<div class="title">Figure 14. Average Rainfall</div>
</div>
<div class="paragraph">
<p>In actuality the SV1 pattern looks like a slight improvement over the the annual average.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../fig/imrg/krabi/monthly/sv-1.svg" alt="sv 1">
</div>
<div class="title">Figure 15. Second Singular Vector (SV2)</div>
</div>
<div class="paragraph">
<p>The second singular vector, orthogonal to the first, shows some very strong east west contrast and but doesn&#8217;t immediately look like any climate system. The large negative values in the north west can&#8217;t be directly interpreted as they don&#8217;t make physical sense for precipitation. Since we aren&#8217;t working off an anomaly (like in an EOF analysis) the climate patterns of precipitation should be positive. Inverting the vector&#8217;s values doesn&#8217;t solve the issue as it would just creates other negative zones.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../fig/imrg/krabi/monthly/sv1sv2.svg" alt="sv1sv2">
</div>
<div class="title">Figure 16. How SV1 and SV2 change over time</div>
</div>
<div class="paragraph">
<p>If we look at how SV1 and SV2 values change over time, we will see a spurious relationship between the two. Interpretting SV1 and SV2 as indicative of distinct climate phenomena may lead one to believe SV2 drives SV1. If the signals are further normalized, then this pattern can be misinterpreted as a phase-lag and create a false link between climate systems (REF: MARTIME CONTINENT PAPER)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_isolating_correct_patterns_in_the_sv_subspace">Isolating correct patterns in the SV subspace</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We already know a priori that the root cause of the observed problems with the singular vectors is that both vectors represent a mixture of all climate signals (O2).
To isolate the two climate systems we need to assume three simplifying characteristics:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">A1</dt>
<dd>
<p>the local climate system can be approximation as a noise dominated system of two signals</p>
</dd>
<dt class="hdlist1">A2</dt>
<dd>
<p>the two climate systems by-in-large don&#8217;t undergo any mixing.
In other words the two climates can&#8217;t coocur.</p>
</dd>
<dt class="hdlist1">A3</dt>
<dd>
<p>The climate patterns in question scale in a near-linear fashion.
If it rains twice as much,
then it rains twice as much across the whole climate associated precipitation region</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>These are the assumptions that were baked in to the synthetic example in SUPP1.</p>
</div>
<div class="paragraph">
<p>In practice the characteristic A1 seems to be a soft requirement.
For instance in the southern Thailand at the seasonal scale we expect additional Madden Julian Oscillations (MJO) and at the interannual scale we expect climate pattern effect from the the El Niño–Southern Oscillation (ENSO).
However, at a glance neither seem to cause clear visually apparent patterns in the data.
Treated these other climate phenomena as background noise has not introduced notable issues in the final result. The authors have no been able to find any locations with three or more visually distinct seasonal rain patterns.</p>
</div>
<div class="paragraph">
<p>One important situation where A1 does not hold is in the trivial case of only one dominant climate system.
Maybe the most common instance would be the one monsoon-related rainy season.
At the seasonal scale,
these climate systems are maybe more the norm than the exception.
In these degenerate cases SV1 (or even the annual average) will be directly giving you a good approximation of the climate related pattern.
We do not present a turnkey solution for distinguishing such regions,
but typically looking at the singular values in a scree plot highlights problematic regions.
Trying to isolate patterns in a single system region also gives characteristic climate indeces that separate out onset/withdrawal periods from the main climate phenomena.
An example is provided in SUPP?????</p>
</div>
<div class="paragraph">
<p>Assuming A1 to be generally true, we can then interpret both singular vectors as largely consisting of different mixtures of the two underlying signals.
By virtue of there being just two degrees of freedom, a certain combination of the two SVs should give back one pattern and a different combination should give us back the other pattern.
Here in our case study that means a mixture of SV1 and SV2 should give us back the summer monsoon pattern,
and a different mixture should give us the winter monsoon pattern.</p>
</div>
<div class="paragraph">
<p>To simplify the problem we can reduce our problem space to two dimensions.
We can replot all 120 monthly rain maps on to two axis.
The X axis will correspond to how much each month of rain corresponds to the first singular vector SV1.
The Y axis corresponds to how much it corresponds to the second singular vector SV2.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../fig/imrg/krabi/monthly/sv-projs-plain.svg" alt="sv projs plain">
</div>
<div class="title">Figure 17. SV1 SV2 data projection</div>
</div>
<div class="paragraph">
<p>These two projections correspond to the first two columns of the left-singular-vector matrix in the SVD.
The reduction to two dimensions has in effect removed the remaining noise-associated SVs.</p>
</div>
<div class="paragraph">
<p>When observed in this subspace the effect of the second simplifying assumption A2 is apparent.
The two climate systems are generally non-coocurring and the precipitation patterns forming two clusters.
One cluster is dominated by summer (yellow) months while the other winter (blue/purple) months.
This corresponds to our intuition.
Either atmospheric parameters are in some summer monsoon associated configuration or in a winter monsoon associated one.
Since these processes happen at synoptic scales,
much larger than the zone under observation,
there is very little time spent "in-between".
For instance the onset of the monsoon at the Southern end and Northern end of the selected region has been estimated to differ by approximately XXX days(REF???).
This stresses the need to select small regions for climate pattern extraction.</p>
</div>
<div class="paragraph">
<p>A2 actually characterizes many natural climate systems.
Systems just as ENSO,
the North Atlantic dipole,
The Southern Annular Mode and the Pacific Decadal Oscillation come in pairs.
These are often called positive and negative phases.
The monsoon similarly has a summer and winter phase.
Since the phases correspond to synoptic scale atmospheric configurations they can not coocur.
There may be short transitionary phases at the regional/mesoscale but their precipitation patterns do not necessarily correspond to a mixture of the two climate systems.
Because the phases are relatively short,
for the purpose of isolating patterns,
these transitions will be interpreted as part of the noise.
SUPP??? shows how in the extreme, such as in one climate system locations, transitions can form a false signals.</p>
</div>
<div class="paragraph">
<p>The two clusters are broadly centered around two lines going through the origin.
These clustering axes represent two ratios of the singular vectors.
To estimate these two ratios we use a procedure akin to Otsu&#8217;s method in computer vision.
We subdivide the 2D subspace along all possible diagonal dichotomies and find the dividing line which minimizes the total variance of both halves.
Such a dividing line in essence ensures both halves form a tight grouping around each half&#8217;s mean</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../fig/imrg/krabi/monthly/sv-projs.svg" alt="sv projs">
</div>
<div class="title">Figure 18. SV1 SV2 data projection divided</div>
</div>
<div class="paragraph">
<p>Once the optimal divisor has been selected (red dashed line),
we find the centroid of each half (black dotted line).
This represents our best estimate of each climate-associated ratio.
The centroid is calculates as the error weighted average of the ratios of SV1 to SV2 across all points on their associate half (see SUPP1 for how errors are estimated).</p>
</div>
<div class="paragraph">
<p>The fact that points generally lie in the direction of the centroid also suggests A3 is a safe approximation.
If stronger monsoon months lead to a change in the shape of the climate pattern then we could see more stark off-axis changes.
Arguably the summer monsoon half does show an off-axis trend.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../fig/imrg/krabi/monthly/top-pattern.svg" alt="top pattern">
</div>
<div class="title">Figure 19. Top half average</div>
</div>
<div class="paragraph">
<p>We can now draw the ratio specified for each centroid.
We first look at the top centroid.
The months in the top half are blue/purple and correspond to the late-fall/winter months.
The pattern represented by the ratio indeed corresponds to the pattern we observed in the raw data and matches our intuitive understanding of the climate configuration during the winter monsoon.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../fig/imrg/krabi/monthly/bottom-pattern.svg" alt="bottom pattern">
</div>
<div class="title">Figure 20. Bottom half average</div>
</div>
<div class="paragraph">
<p>Similarly the bottom half consists of summer months,
and the centroid-associated ratio produces a mixture of SV1 and SV2 such that the resulting pattern looks like the summer monsoons we observed in the original data.
Note how the previous artifacts we saw in SV1,
with spurious rains on the East coast,
have completely vanished</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_supp_error_analysis">SUPP: Error Analysis</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For the purpose of this analysis we will not be considering instrument error as this goes in to the specifics of the IMERG system and is outside the scope of the method</p>
</div>
<div class="paragraph">
<p>The error propagation will be explained in several steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>We first will characterize the noise</p>
</li>
<li>
<p>Then we will explain how it affects the projections in the SV1 SV2 subspace of FIG????</p>
</li>
<li>
<p>This then will establish an error of the climate patterns themselves (FIG?? FIG??)</p>
</li>
<li>
<p>After which we can estimate the error of the climate index - ie. the projections of the time points on to the climate patterns themselves.</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_1_the_noise">1: The Noise</h3>
<div class="paragraph">
<p>The simplifying characteristic A1 tells us that if we remove the first two singular vectors we are left with an estimate of the noise component of the system.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../fig/imrg/krabi/monthly/noise-all.svg" alt="noise all">
</div>
<div class="title">Figure 21. De-noised data (ie. data with SV1 and SV2 removed)</div>
</div>
<div class="paragraph">
<p>The de-signaled data,
as expected,
looks like noise with no discernible climate patterns.
This remaining noise should have an expected value of zero.
Any non-zero value would in-effect indicate some additional climate signal,
which would run counter to <strong>A1</strong>.</p>
</div>
<div class="paragraph">
<p>The noise&#8217;s variance generally increases with an increase in monsoon signal.
Visually we saw in FIG??? that the monsoon pattern manifests unevenly.
Intuitively,
we expect that when there is little signal/monsoon thing are dryer and the noise level is reduced.
When the climate signal is strong the noise level is higher.
At such times some patches may remain entirely dry,
while others may have large amounts of precipitation.</p>
</div>
<div class="paragraph">
<p>To observe this,
we can re-plot the months by their power in SV1+SV2 compared to the power of the remaining SVs (SV3,SV4,SV5,..etc).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../fig/imrg/krabi/monthly/power-sv12-vs-other.svg" alt="power sv12 vs other">
</div>
<div class="title">Figure 22. Signal to Noise plot</div>
</div>
<div class="paragraph">
<p>Unfortunately,
while there is a general linear relationship,
it isn&#8217;t very robust.
There are many outliers and a lot of variability.</p>
</div>
</div>
<div class="sect2">
<h3 id="_2_error_in_the_2d_sv1_sv2_subspace">2. Error in the 2D SV1 SV2 subspace</h3>
<div class="paragraph">
<p>The noise level is important because it affects our estimates of projections.
While the expected value of the noise is zero,
the actual mean will never be exactly zero.
The variance of the measured mean is akin to the classic standard deviation of the mean (SDOM).
When you project your data on to a pattern (ex: SV1 or SV2),
the mean of the noise in areas of the pattern will be folded in to the projection.
So when calculating the inner product of the pattern and measurement,
the noise will cause you to either overestimate or underestimate the strength of your signal.</p>
</div>
<div class="paragraph">
<p>So when we took our data points and placed them on the SV1 SV2 plot (FIG????),
we had implicitly done this projection.
The noise&#8217;s mean at every point in time was folded into the projections and had skewed our results.
While the size of the skew can&#8217;t be know directly,
the magnitude can be estimated by knowing the variance of the noise.</p>
</div>
<div class="paragraph">
<p>For the purpose of this analysis we treat the SV1 and SV2 patterns/vectors as both having negligible errors relative to the data.</p>
</div>
<div class="paragraph">
<div class="title">TODO:</div>
<p>IS THIS A SAFE ASSUMPTION? DO I NEED TO ESTIMATE THE ERROR OF THE SV? CAN BE DONE BY DIVIDING DATASET AND CALCULATING.. OR SOME BOOTSTRAP?</p>
</div>
<div class="paragraph">
<p>We had originally gotten the projections by looking at the left singular vectors of the SVD.
However,
if done explicitly,
the projecting is done by taking the inner product of the data and the pattern.
Note that the left singular vectors are unit length,
While the projections are not.
So the final errors need to be divided by the corresponding singular value to be at the same scale
In other words we go pixel by pixel multiplying the pattern <strong>P</strong> with the data <strong>D</strong> and summing them all up:</p>
</div>
<div class="paragraph">
<p>\$sum_(pxl=1)^n P_{pxl}*D_{pxl}\$</p>
</div>
<div class="paragraph">
<p>The pattern pixels <strong>P</strong> have negligible errors so we treat them as constant.
The data pixels for each time point <strong>D</strong> are some signal <strong>S</strong> with some noise <strong>N</strong></p>
</div>
<div class="paragraph">
<p>\$sum_(pxl=1)^n P_{pxl}*(S_{pxl} +- N_{pxl)}\$</p>
</div>
<div class="paragraph">
<p>We can separate this into the original inner product and the sum of zero mean errors:</p>
</div>
<div class="paragraph">
<p>\$sum_(pxl=1)^n P_{pxl}*S_{pxl} +  sum_(pxl=1)^n 0 +- P_{pxl}*N_{pxl}\$</p>
</div>
<div class="paragraph">
<p>The best estimate of <strong>S</strong> is <strong>D</strong> so the left hand side is just our original inner product.
The error of the sum of errors is their quadrature sum.
So the final inner product will be:</p>
</div>
<div class="paragraph">
<p>\$sum_(pxl=1)^n P_{pxl}*S_{pxl} +- sqrt(sum_(pxl=1)^n (P_{pxl}*N_{pxl})^2)\$</p>
</div>
<div class="paragraph">
<p>The last step is deciding on a value for <strong>N</strong>.
One option is to use the linear relation from FIG????.
However this presupposes a constant noise power across the whole field and that the noise level is purely a function of the signal strength.
Fortunately since the patterns fields are large and since we have many pixels and can directly estimate the noise level at every point in time.
If we treat each pixel as a separate random process with mean zero and unknown standard deviation then the designaled data gives us one trial.
The absolute value of the designaled pixel is our best estimate of of the standard deviation <strong>N</strong>.
So the error estimate is quadrature sum of the product of the designalled data and the pattern.</p>
</div>
<div class="paragraph">
<p>At this step the pattern <strong>P</strong> is either <strong>SV1</strong> or <strong>SV2</strong>.
The quadrature sum, after dividing by the corresponding singular value, provides the X and Y error in FIG????.
Note also that a larger pattern will make the relative noise smaller.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../fig/imrg/krabi/monthly/sv-projs-with-errors.svg" alt="sv projs with errors">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_3_error_in_climate_pattern">3. Error in climate pattern</h3>
<div class="paragraph">
<p>Now each data point in the SV1 SV2 plane has X and Y errors which we will call dX and dY.
To find the ratio of SV1 and SV2 associate with each climate pattern,
we first need to calculate the associated ratio for each data point.
If we calculate X/Y for each point then the associate error is the sum in quadrature of the fractional uncertainties:</p>
</div>
<div class="paragraph">
<p>\$X/Y +- sqrt(((dX)/X)^{2} + ((dY)/Y)^{2}\$</p>
</div>
<div class="ulist">
<div class="title">TODO:</div>
<ul>
<li>
<p>RATIO SEEM PROBLEMATIC AS IT EXPLODES TO HUGE VALUES AS Y GOES TO ZERO.</p>
</li>
<li>
<p>MAYBE RADIANS?</p>
</li>
<li>
<p>MAYBE PERCENTAGE OF SV1? (X/(X+Y))</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When calculating the averages and variances of each half we now use these ratios with their associated errors.
Assume the errors are independent and normally distributed,
we can use the variances to make a weighted average and calculate a weighted variance</p>
</div>
<div class="paragraph">
<p><a href="https://en.wikipedia.org/wiki/Inverse-variance_weighting" class="bare">https://en.wikipedia.org/wiki/Inverse-variance_weighting</a></p>
</div>
<div class="ulist">
<div class="title">TODO:</div>
<ul>
<li>
<p>SHOULD I ADDRESS THE INDEPENDENT/NORMAL CRITERIA..?</p>
</li>
<li>
<p>OR FIND AN ELEGANT WAY TO ACKNOWLEDGE AND SKIP IT..?</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When the variance minimizing divider is found,
the average will yield a ratio that corresponds to each the climate pattern.
The associated variance will specify the error in that ratio.
We can then use the error in the SV1 SV2 ratio to calculate average + error and average - error patterns and thereby calculate a pixel level standard deviation.
Naturally areas with high values in SV1 and SV2 will result in higher errors.</p>
</div>
<div class="paragraph">
<p>THE ERRORS "BARS" ARE LIKELY NOT SYMMETRIC.. NOT SURE HOW TO HANDLE/DISPLAY</p>
</div>
<div class="ulist">
<div class="title">TODO:</div>
<ul>
<li>
<p>A MAP OR THE ERRORS FOR SUMMER AND WINTER MONSOONS??</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_4_error_in_climate_index">4. Error in Climate Index</h3>
<div class="paragraph">
<p>The final error to be determined is the error in the final calculated climate index.
This is the projection of each time/data point on to each climate pattern.
Here the procedure is the same as when we projected on to SV1 and SV2.
However, while we treated SV1 and SV2 as having no effective error,
here we treat the climate patterns as having an error.</p>
</div>
<div class="paragraph">
<p>\$sum_(pxl=1)^n P_{pxl}*D_{pxl}\$</p>
</div>
<div class="paragraph">
<p>So in the previous equation both P and D now have an error associated with them.</p>
</div>
<div class="paragraph">
<p>\$sum_(pxl=1)^n P_{pxl}*S_{pxl} +- N_{pxl}\$</p>
</div>
<div class="paragraph">
<p>Here N is the quadrature sum of the fractional uncertainties.
We then proceed as before doing a quadrature sum of these combined probabilities.
This gives us the error bars on the final climate index projections.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_applications_climate_patterns">Applications: Climate Patterns</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The previous steps have given us clean non-orthogonal climate patterns.
These can serve as a basis for further research.
First,
the spatial distribution of the pattern itself can serve as a source of truth.
Second,
once the pattern is isolated we can look for it in future (and past) data.</p>
</div>
<div class="paragraph">
<p>The pattern as a source of truth can be useful when for instance looking at changes in atmospheric parameters.
However, this needs to be evaluated on a case by case basis.
A more direct approach would be for instance validating a climate model.</p>
</div>
<div class="ulist">
<div class="title">TODO</div>
<ul>
<li>
<p>ERA5 PLOTS</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If we are to run the identical method on ERA5 monthly precipitation for the same period</p>
</div>
<div class="paragraph">
<p>We get the following winter monsoon associated pattern</p>
</div>
<div class="paragraph">
<p>And the following summer monsoon associated pattern</p>
</div>
<div class="paragraph">
<p>While the original data is at a coarser resolutions,
the two patterns seem to generally correspond in this region of interest.
Interestingly enough,
noise levels are reduced .. blah blah</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_applications_climate_indeces">Applications: Climate Indeces</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using the pattern to look for the presence of climate at past and future times can form the bases of constructing climate indeces.
Many climate indeces are built on the bases of using EOF analysis - particularly the first singular vector,
EOF1.
These methods typically give plausible results due to two common phenomena.
First,
as was noted before,
most climate phenomena come in pairs.
Second,
often climate phenomena are close negatives of each other when viewed as anomalies from the mean.
The rain patterns derived for the Thai peninsula,
if normalized to be around zero,
as a very rough level resemble negatives of each other (especially if you were to stencil out the oceans).</p>
</div>
<div class="paragraph">
<p>Similar near-negatives can be imagined for other climate phenomena.
For instance sea surface temperatures associated with the El Nino equatorial warm water tongue vs the La Nina subtropical heating are near negatives when viewed in small boxes around the equator (REF).
The positive and negative phases of the southern annular mode,
or the north atlantic dipole also look like negatives within their respective zones of influence.</p>
</div>
<div class="paragraph">
<p>This means that EOF1 (which is done on an anomaly and not raw data),
with a properly tuned region,
may produce a pattern which gives a one dimension estimate of both climate phenomena.
This however is not a property that is universally true - and doesn&#8217;t have a clear universal scientific rational.</p>
</div>
<div class="paragraph">
<p>Using climate patterns provide by subspace bisection allows us to entirely avoid the serendipity of this second requirement and allows us to look at the presence of climate in less convenient regions.
We treat each climate pattern separately and we will generate two independent indices with non-comparable scalings.
To build an index based on our climate data we simply need to project data on to our patterns.
We use the bisecting line (red line Fig XX) to determine which pattern each data point should be projected on.
The projection can either be done directly (ie. an inner product of the pattern and data) or can be done with a non orthogonal projection in the 2D singular vector subspace.
We reject the nonorthogonal method because data points are conceptually attributed to one climate system or the other and don&#8217;t represent a mixture.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../fig/imrg/krabi/monthly/indeces.svg" alt="indeces">
</div>
<div class="title">Figure 23. Climate Indeces</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_conclusions_and_limitations">Conclusions and limitations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>TODO</p>
</div>
<div class="paragraph">
<p>Identifying and removing mean structure in more complex scenarios (ex: seasonal data subsets) is a potential area for future work.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_supp_pattern_separation_at_different_time_scales">SUPP Pattern separation at different time scales</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In our primary case study we look at precipitation totals at the pentad scale.
This integration time, or time box size, was chosen to help illustrate the method.
It gives nice separation in the SV12 subspace while avoiding the issue of longer time-boxes.</p>
</div>
<div class="paragraph">
<p>In this section we will do a quick overview of the behavior seen with larger and smaller integration times</p>
</div>
<div class="sect2">
<h3 id="_large_time_boxes">Large time boxes</h3>
<div class="paragraph">
<p>We first look at the issues that arise with larger time windows by looking at the same region using monthly precpitation values.
Monthly maps are provided directly by the IMERG</p>
</div>
<div class="paragraph">
<p>TODO: IMAGE OF MONTHLY SV12</p>
</div>
<div class="paragraph">
<p>What we start to see is a proportion of the higher energy (ie. further from the origin) data points lie between the two climate clusters. A large fraction of these occur during the late Fall (purple/violet) and correspond to transition points. The change from Summer Monsoon to Winter monsoon occurs rapidly in the region. The month-long time box in effect captures a certain amount of summer monsoon, indeterminate transition state, and winter monsoon. The final monthly map looks like a mixture of the two monsoon signals! This is an aliasing-type problem that runs counter to the method&#8217;s built-in assumption that the climate will never coocurring.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_small_time_boxes">Small time boxes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We can also decrease the time box size. Decreasing the time step effectively provides us with more data points for a give period of time. The practical limit is a daily average - as any smaller time increment would need to contend with diurnal variability. Diurnal climate patterns are definitely present, but the separation of diurnal climate systems from seasonal (and potentially interannual) patterns is an area for future work and outside the scope of the current method. At the daily time-scale we may still observe transitional states, where neither climate system is established and hence neither pattern is present. However, we become less likely to capture actual mixing of mutliple climate systems in one integration time-step</p>
</div>
<div class="paragraph">
<p>When we observe the SV1 SV2 subspace again, we no longer see a distinct two-cluster system. At first glance it looks like all points are a mixture of the end members.</p>
</div>
<div class="paragraph">
<p>TODO: Image of daily SV12 subspace</p>
</div>
<div class="paragraph">
<p>However when we do our variance minimization method and look at the two centroids we find that the resulting patterns are identical</p>
</div>
<div class="paragraph">
<p>TODO: Daily patterns</p>
</div>
<div class="paragraph">
<p>Replotting all the data&#8217;s angular component - a histogram shows that in the cloud of points you are getting two peaks. Each point is just perturbed by such a large amount of noise that the previously distinct clusters are lost. Unfortunately the variability in this subspace greatly exceeds the variability estimates in our Error Analysis, which suggests there is some room for improvement.</p>
</div>
<div class="paragraph">
<p>Looking at this spread one can&#8217;t help but notice the wedge-like shape. These top and bottom edges of the wedge are not mixing end-member but in effect delimit an "allowed" zone of SV1 SV2 mixtures. Note how SV2 has large positive and negative values. Projections outside these zones would represent in mixtures that result in large negative zones in these SV1, SV2 component sums. Since precipitation must always be positive, the remaining noise would need to "fill in" these negative zones - which becomes increasingly unlikely as the zone becomes larger.</p>
</div>
<div class="paragraph">
<p>Looking at the resulting climate index we can oberserve the monsoons at the daily scale with with effectively a lot of noise. Some days in the middle of the summer are classified as winter monsoon days and vice versa. Since we don&#8217;t have a good characterization of the variability we leave providing a comprehensive methodology for interpreting misclassified days as an area for future work. Re-interpreting the data in pentads or other time slices at the climate index level could potentially provide resolve this issue, but would require some criteria of a new integration window. If you know the there is one climate transition per year (ex: summer to winter monsoon) one could potentially tailor a statistical method to detect this transition point</p>
</div>
<div class="paragraph">
<p>In short, smaller time steps do not hurt the climate pattern extraction process, but may create an extremely high resolution noisy climate index that is challenging to interpret.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_supp_rift_valley_non_cyclical_signals">SUPP Rift Valley: Non cyclical signals</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Unlike many EOF enhancements, the methodology as currently illustrated does not make any assumptions about climate variability over time. There are no assumptions that one climate follows another or that they occur at similar times of the year/day. This allows us to look at some more unusual climate phenomena such as the rain patters of the Rift Valley in Eastern Africa</p>
</div>
<div class="paragraph">
<p>TODO: All (monthly?) data</p>
</div>
<div class="paragraph">
<p>Here there are two rain-associated climate systems which in Ethiopia as called the Belg and the Kiremt</p>
</div>
<div class="paragraph">
<p><a href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1002/2016RG000544" class="bare">https://agupubs.onlinelibrary.wiley.com/doi/full/10.1002/2016RG000544</a></p>
</div>
<div class="paragraph">
<p>TODO: Read this thing..</p>
</div>
<div class="paragraph">
<p>While boreal summer Kiremt rains come at a consistent time every year, Belg "short" rains as a lot less consistent and associated . However the illutrated method has no issue extracting these patterns.</p>
</div>
<div class="paragraph">
<p>TODO: SV12 projs</p>
</div>
<div class="paragraph">
<p>TODO: Patterns</p>
</div>
<div class="paragraph">
<p>TOOO: Climate index</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_supp_sahel_mountain_marrah_method_used_in_a_one_signal_region">SUPP: Sahel Mountain (Marrah): Method used in a one signal region</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It must be noted that globally, most locations do not feature a bistable climate. The most common scenario is a simple one-system precipitation climate (at the seasonal scale). In these locations no tricks are necessary. The first singular vector (or first EOF) will extract the single pattern.</p>
</div>
<div class="paragraph">
<p>So it is interesting to try to observe what occurs if we apply your method in these situations. As a case study we look at the Marrah mountains in southern Sudan. This massif lies at the edge of the Sahel and is subject to a single monsoon-driven rainy season. The massif&#8217;s topography has some interplay with the monsoon related atmospheric configuration which drives the dominant precipitation pattern.</p>
</div>
<div class="paragraph">
<p>TODO: SV12 plot</p>
</div>
<div class="paragraph">
<p>First note that we no longer see a clear separation in the SV12 subspace. The data presents an even spread across the allowable wedge. The two extracted patterns no longer have a clear physical interpretations</p>
</div>
<div class="paragraph">
<p>TODO: Pattern 1 &amp;2</p>
</div>
<div class="paragraph">
<p>But when we look at the resulting climate pattern we do see a consistent pattern</p>
</div>
<div class="paragraph">
<p>TODO: Climate index</p>
</div>
<div class="paragraph">
<p>The single pattern is being torn apart in to a monsoon signal and an onset/withdrawl pattern. Remember that one of the assumptions of the EOF  (A3) was that:
" The climate patterns in question scale in a near-linear fashion.
If it rains twice as much,
then it rains twice as much across the whole climate associated precipitation region"</p>
</div>
<div class="paragraph">
<p>Here we see this assumption fall apart as the weaker onset/withdrawl monsoon takes on a warped shaped as compared to the middle of the rainy season.
This onset/withdrawl false pattern occurs regularly when the method is applied in single-system regions and is a good indicator that the method should skipped in favor of simply using the first singular vector (or first EOF1).</p>
</div>
<div class="paragraph">
<p>A look at the singular values confirms also gives us a strong indication there is effectively no second climate system at the seasonal scale</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_supp_diurnal_cycles_maritime_continent">SUPP Diurnal cycles: Maritime continent</h2>
<div class="sectionbody">
<div class="paragraph">
<p>So far we have limited ourselves to seasonal climate systems. However the method may work at other time scales. Here we present a quick examination of the diurnal cycle off the coast of Java for the period (TODO Specify period):</p>
</div>
<div class="paragraph">
<p>TODO: Data image</p>
</div>
<div class="paragraph">
<p>Again IMERG can be used as it provides extremely high resolution data at the half hour interval</p>
</div>
<div class="paragraph">
<p>TODO: SV12 plot</p>
</div>
<div class="paragraph">
<p>We again get some separation ..</p>
</div>
<div class="paragraph">
<p>A lot of intermediary state</p>
</div>
<div class="paragraph">
<p>Very noisy input</p>
</div>
<div class="paragraph">
<p>But it kinda works..
And you can have a lot more input data</p>
</div>
<div class="paragraph">
<p>Watch out for seasonal signals.
Separation of signals at different time scales is outside the scope of the paper</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_supp_korean_peninsula_large_region_vs_small_region">SUPP Korean Peninsula: Large Region vs Small Region</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We noted in passing that working at the mesoscale allows us to get clear climate onset/withdrawl.
Here we present results when a region that is too large is used.
We look at the Korean Peninsular at two different scales</p>
</div>
<div class="paragraph">
<p>Things go bad</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_supp_notes_on_imerg">SUPP: Notes on IMERG</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For the Southern Thailand case study we selected to use the V06B Late data provided by IMERG (in GeoTIFF format). We find that other versions produce notable issues related to a "climatological adjustment" made using GPCC gauge data. This rain gauge correction was added to the "Final" version of version V06B. In version V07B the correction is incorporated in both Late and Final version. The Early version is still unaffected, however it "only has forward propagation (which basically amounts to extrapolation forward in time), while the Late has both forward and backward propagation (allowing interpolation)". See: <a href="https://gpm.nasa.gov/data/imerg" class="bare">https://gpm.nasa.gov/data/imerg</a> FAQ Section.</p>
</div>
<div class="paragraph">
<p>The adjustment creates a notable stenciling effect. The stencil seems to reflect the GPCC stencil seen in GPCC precipitation maps:
<a href="https://climatedataguide.ucar.edu/climate-data/gpcc-global-precipitation-climatology-centre" class="bare">https://climatedataguide.ucar.edu/climate-data/gpcc-global-precipitation-climatology-centre</a></p>
</div>
<div class="paragraph">
<p>Here is an example using v7 monthly data:</p>
</div>
<div class="paragraph">
<p>TODO add images</p>
</div>
<div class="paragraph">
<p>V06 is provided in several different subversion. One is labeled V06B and GeoTIFF files are provided through 2022-05-07. The next next period goes through multiple version through 2024-06-02. To avoid any discontinuities in the analysis. We look at v06B data exclusively on the 2011-01-01 to 2020-12-31 (inclusive) period.</p>
</div>
<div class="paragraph">
<p>To simplify the analysis and create even annual cycles we subdivide the 365 day calandar year into pentads by removing all occurances of the leap day - February 29th.</p>
</div>
</div>
</div>
</div>
</body>
</html>